# SOME DESCRIPTIVE TITLE.
# FIRST AUTHOR <EMAIL@ADDRESS>, YEAR.
#
#, fuzzy
msgid ""
msgstr ""
"Project-Id-Version: PACKAGE VERSION\n"
"Report-Msgid-Bugs-To: http://bugs.kde.org\n"
"POT-Creation-Date: 2017-01-20 18:23+0000\n"
"PO-Revision-Date: YEAR-MO-DA HO:MI+ZONE\n"
"Last-Translator: FULL NAME <EMAIL@ADDRESS>\n"
"Language-Team: LANGUAGE <kde-i18n-doc@kde.org>\n"
"MIME-Version: 1.0\n"
"Content-Type: text/plain; charset=UTF-8\n"
"Content-Transfer-Encoding: 8bit\n"

#. Tag: title
#: selinux.xml:9 selinux.xml:479
#, no-c-format
msgid "Configuring &selnx;"
msgstr ""

#. Tag: para
#: selinux.xml:15
#, no-c-format
msgid ""
"In this chapter, you will learn how to set up and manage &selnx; on "
"&productname;. The following topics are covered:"
msgstr ""

#. Tag: para
#: selinux.xml:21
#, no-c-format
msgid "<para>Why Use &selnx;?</para>"
msgstr ""

#. Tag: para
#: selinux.xml:26
#, no-c-format
msgid "Understanding &selnx;"
msgstr ""

#. Tag: para
#: selinux.xml:31
#, no-c-format
msgid "Setting Up &selnx;"
msgstr ""

#. Tag: para
#: selinux.xml:36
#, no-c-format
msgid "<para>Managing &selnx;</para>"
msgstr ""

#. Tag: title
#: selinux.xml:42
#, no-c-format
msgid "<title>Why Use &selnx;?</title>"
msgstr ""

#. Tag: para
#: selinux.xml:44
#, no-c-format
msgid ""
"&selnx; was developed as an additional Linux security solution that uses the "
"security framework in the Linux kernel. The purpose was to allow for a more "
"granular security policy that goes beyond what is offered by the default "
"existing permissions of Read, Write, and Execute, and beyond assigning "
"permissions to the different capabilities that are available on Linux. "
"&selnx; does this by trapping all system calls that reach the kernel, and "
"denying them by default. This means that on a system that has &selnx; "
"enabled and nothing else configured, nothing will work. To allow your system "
"to do anything, as an administrator you will need to write rules and put "
"them in a policy."
msgstr ""

#. Tag: para
#: selinux.xml:57
#, no-c-format
msgid ""
"An example explains why a solution such as &selnx; (or its counterpart &aa;) "
"is needed:"
msgstr ""

#. Tag: quote
#: selinux.xml:63
#, no-c-format
msgid ""
"One morning, I found out that my server was hacked. The server was running a "
"fully patched &slsa; installation. A firewall was configured on it and no "
"unnecessary services were offered by this server. Further analysis learned "
"that the hacker had come in through a flaky PHP script that was a part of "
"one of the Apache virtual hosts that were running on this server. The "
"intruder had managed to get access to a shell, using the <systemitem class="
"\"username\">wwwrun</systemitem> account that was used by the Apache Web "
"server. As this <systemitem class=\"username\">wwwrun</systemitem> user, the "
"intruder had created several scripts in the <filename>/var/tmp</filename> "
"and the <filename>/tmp</filename> directories, which were a part of a botnet "
"that was launching a Distributed Denial of Service attack against several "
"servers."
msgstr ""

#. Tag: para
#: selinux.xml:78
#, no-c-format
msgid ""
"The interesting thing about this hack is that it occurred on a server where "
"nothing was really wrong. All permissions where set OK, but the intruder had "
"managed to get into the system. What becomes clearly evident from this "
"example is that in some cases additional security is needed&mdash;a security "
"that goes beyond what is offered by using &selnx;. As a less complete and "
"less complex alternative, &aa; can be used."
msgstr ""

#. Tag: para
#: selinux.xml:88
#, no-c-format
msgid ""
"&aa; confines specific processes in their abilities to read/write and "
"execute files (and other things). Its view is mostly that things that happen "
"inside a process cannot escape."
msgstr ""

#. Tag: para
#: selinux.xml:94
#, no-c-format
msgid ""
"&selnx; instead uses labels attached to objects (for example, files, "
"binaries, network sockets) and uses them to determine privilege boundaries, "
"thereby building up a level of confinement that can span more than a process "
"or even the whole system."
msgstr ""

#. Tag: para
#: selinux.xml:101
#, no-c-format
msgid ""
"&selnx; was developed by the US National Security Agency (NSA), and since "
"the beginning Red Hat has been heavily involved in its development. The "
"first version of &selnx; was offered in the era of <trademark>Red Hat "
"Enterprise Linux 4</trademark>, around the year 2006. In the beginning it "
"offered support for essential services only, but over the years it has "
"developed into a system that offers many rules that are collected in "
"policies to offer protection to a broad range of services."
msgstr ""

#. Tag: para
#: selinux.xml:111
#, no-c-format
msgid ""
"&selnx; was developed in accordance with some certification standards like "
"Common Criteria and FIPS 140. Because some customers specifically requested "
"solutions that met these standards, &selnx; rapidly became relatively "
"popular."
msgstr ""

#. Tag: para
#: selinux.xml:118
#, no-c-format
msgid ""
"As an alternative to &selnx;, Immunix, a company that was purchased by "
"Novell in 2005, had developed &aa;. &aa; was built on top of the same "
"security principles as &selnx;, but took a completely different approach, "
"where it was possible to restrict services to exactly what they needed to do "
"by using an easy to use wizard-driven procedure. Nevertheless, &aa; has "
"never reached the same status as &selnx;, even if there are some good "
"arguments to secure a server with &aa; rather than with &selnx;."
msgstr ""

#. Tag: para
#: selinux.xml:128
#, no-c-format
msgid ""
"Because many organizations are requesting &selnx; to be in the Linux "
"distributions they are using, &suse; is offering support for the &selnx; "
"framework in &productname;. This does not mean that the default installation "
"of &productname; will switch from &aa; to &selnx; in the near future."
msgstr ""

#. Tag: title
#: selinux.xml:137
#, no-c-format
msgid "Support Status"
msgstr ""

#. Tag: para
#: selinux.xml:138
#, no-c-format
msgid ""
"The &selnx; framework is supported on &productname;. This means that "
"&productnameshort; offers all binaries and libraries you need to be able to "
"use &selnx; on your server. You may however miss some software that you may "
"be familiar with from other Linux distributions."
msgstr ""

#. Tag: para
#: selinux.xml:144
#, no-c-format
msgid ""
"&selnx; support is at a fairly early stage in &productname;, which means "
"that unexpected behavior may occur. To limit this risk as much as possible, "
"it is best to use only the binaries that have been provided by default on "
"&productname;."
msgstr ""

#. Tag: title
#: selinux.xml:153
#, no-c-format
msgid "Understanding &selnx; Components"
msgstr ""

#. Tag: para
#: selinux.xml:154
#, no-c-format
msgid ""
"Before starting the configuration of &selnx;, you should know a bit about "
"how &selnx; is organized. Three components play a role:"
msgstr ""

#. Tag: para
#: selinux.xml:160
#, no-c-format
msgid "The security framework in the Linux kernel"
msgstr ""

#. Tag: para
#: selinux.xml:165
#, no-c-format
msgid "The &selnx; libraries and binaries"
msgstr ""

#. Tag: para
#: selinux.xml:170
#, no-c-format
msgid "The &selnx; policy"
msgstr ""

#. Tag: para
#: selinux.xml:175
#, no-c-format
msgid ""
"The default kernel of &productname; supports &selnx; and the tools that are "
"needed to manage it. The most important part of the work of the "
"administrator with regard to &selnx; is managing the policy."
msgstr ""

#. Tag: para
#: selinux.xml:180
#, no-c-format
msgid ""
"In the &selnx; policy, security labels are applied to different objects on a "
"Linux server. These objects typically are users, ports, processes and files. "
"Using these security labels, rules are created that define what is and what "
"is not allowed on a server. Remember, by default &selnx; denies everything, "
"and by creating the appropriate rules you can allow the access that is "
"strictly necessary. Rules should therefore exist for all programs that you "
"want to use on a system. Alternatively, you should configure parts of a "
"system to run in unconfined mode, which means that specific ports, programs, "
"users, files and directories are not protected by &selnx;. This mode is "
"useful if you only want to use &selnx; to protect some essential services, "
"while you are not specifically worried about other services. To get a really "
"secure system, you should avoid this."
msgstr ""

#. Tag: para
#: selinux.xml:195
#, no-c-format
msgid ""
"To ensure the appropriate protection of your system, you need an &selnx; "
"policy. This must be a tailor-made policy in which all files are provided "
"with a label, and all services and users have a security label as well to "
"express which files and directories can be accessed by which user and "
"processed on the server. Developing such a policy is a tremendous amount of "
"work."
msgstr ""

#. Tag: para
#: selinux.xml:203
#, no-c-format
msgid ""
"The complexity of &selnx; is also one of the main arguments against using "
"it. Because a typical Linux system is so very complex, it is easy to "
"overlook something and leave an opening that intruders can abuse to get into "
"your system. And even if it is set up completely the way it should be, it "
"still is very hard for an administrator to overlook all aspects with "
"&selnx;. With regard to the complexity, &aa; takes a completely different "
"approach and works with automated procedures that allow the administrator to "
"set up &aa; protection and understand exactly what is happening."
msgstr ""

#. Tag: para
#: selinux.xml:214
#, no-c-format
msgid ""
"Note that a freely available &selnx; policy might work on your server, but "
"is unlikely to offer the same protection as a custom policy. &suse; also "
"does not support third-party policies."
msgstr ""

#. Tag: title
#: selinux.xml:222
#, no-c-format
msgid "Policy"
msgstr ""

#. Tag: para
#: selinux.xml:224
#, no-c-format
msgid ""
"As mentioned, the policy is the key component in &selnx;. It defines rules "
"that specify which objects can access which files, directories, ports and "
"processes on a system. To do this, a security context is defined for all of "
"these. On an &selnx; system where the policy has been applied to label the "
"file system, you can use the <command>ls -Z</command> command on any "
"directory to find the security context for the files in that directory. "
"<xref linkend=\"ex.selnx.con.set\" xrefstyle=\"select:label quotedtitle "
"nopage\"/> shows the security context settings for the directories in the "
"<filename>/</filename> directory of a &productname; system with an &selnx;-"
"labeled file system."
msgstr ""

#. Tag: title
#: selinux.xml:239
#, no-c-format
msgid "Security Context Settings Using <command>ls -Z</command>"
msgstr ""

#. Tag: screen
#: selinux.xml:240
#, no-c-format
msgid ""
"ls -Z\n"
"system_u:object_r:bin_t bin\n"
"system_u:object_r:boot_t boot\n"
"system_u:object_r:device_t dev\n"
"system_u:object_r:etc_t etc\n"
"system_u:object_r:home_root_t home\n"
"system_u:object_r:lib_t lib\n"
"system_u:object_r:lib_t lib64\n"
"system_u:object_r:lost_found_t lost+found\n"
"system_u:object_r:mnt_t media\n"
"system_u:object_r:mnt_t mnt\n"
"system_u:object_r:usr_t opt\n"
"system_u:object_r:proc_t proc\n"
"system_u:object_r:default_t root\n"
"system_u:object_r:bin_t sbin\n"
"system_u:object_r:security_t selinux\n"
"system_u:object_r:var_t srv\n"
"system_u:object_r:sysfs_t sys\n"
"system_u:object_r:tmp_t tmp\n"
"system_u:object_r:usr_t usr\n"
"system_u:object_r:var_t var"
msgstr ""

#. Tag: para
#: selinux.xml:243
#, no-c-format
msgid ""
"The most important line in the security context is the context type. This is "
"the part of the security context that ends in _t. It tells &selnx; which "
"kind of access the object is allowed. In the policy, rules are specified to "
"define which type of user or which type of role has access to which type of "
"context. For example, this can happen by using a rule like the following:"
msgstr ""

#. Tag: screen
#: selinux.xml:252
#, no-c-format
msgid "allow user_t bin_t:file {read execute gettattr};"
msgstr ""

#. Tag: para
#: selinux.xml:254
#, no-c-format
msgid ""
"This example rule states that the user who has the context type <systemitem "
"class=\"username\">user_t</systemitem> (this user is called the source "
"object) is allowed to access objects of class \"file\" with the context type "
"<filename>bin_t</filename> (the target), using the permissions read, execute "
"and getattr."
msgstr ""

#. Tag: para
#: selinux.xml:262
#, no-c-format
msgid ""
"The standard policy that you are going to use contains a huge amount of "
"rules. To make it more manageable, policies are often split into modules. "
"This allows administrator to switch protection on or off for different parts "
"of the system."
msgstr ""

#. Tag: para
#: selinux.xml:269
#, no-c-format
msgid ""
"When compiling the policy for your system, you will have a choice to either "
"work with a modular policy, or a monolithic policy, where one huge policy is "
"used to protect everything on your system. It is strongly recommended to use "
"a modular policy and not a monolithic policy. Modular policies are much "
"easier to manage."
msgstr ""

#. Tag: title
#: selinux.xml:278
#, no-c-format
msgid "Installing &selnx; Packages and Modifying &grub;"
msgstr ""

#. Tag: para
#: selinux.xml:280
#, no-c-format
msgid ""
"The easiest way to make sure that all &selnx; components are installed is by "
"using &yast;. The procedure described below shows what to do on an installed "
"&productname;:"
msgstr ""

#. Tag: para
#: selinux.xml:288
#, no-c-format
msgid ""
"Log in to your server as <systemitem class=\"username\">root</systemitem> "
"and start &yast;."
msgstr ""

#. Tag: para
#: selinux.xml:294
#, no-c-format
msgid ""
"Select <menuchoice> <guimenu>Software</guimenu> <guimenu>Software "
"Management</guimenu> </menuchoice>"
msgstr ""

#. Tag: para
#: selinux.xml:300
#, no-c-format
msgid ""
"<menuchoice> <guimenu>Select View</guimenu> <guimenu>Patterns</guimenu> </"
"menuchoice> and select the entire C<guimenu>/C++ Development</guimenu> "
"category for installation."
msgstr ""

#. Tag: para
#: selinux.xml:306
#, no-c-format
msgid ""
"<menuchoice> <guimenu>Select View</guimenu> <guimenu>Search</guimenu> </"
"menuchoice> and make sure that <guimenu>Search in Name</guimenu>, "
"<guimenu>Keywords</guimenu> and <guimenu>Summary</guimenu> are selected. Now "
"enter the keyword <literal>selinux</literal> and click <guimenu>Search</"
"guimenu>. You now see a list of packages."
msgstr ""

#. Tag: para
#: selinux.xml:315
#, no-c-format
msgid ""
"Make sure that all the packages you have found are selected and click "
"<guimenu>Accept</guimenu> to install them."
msgstr ""

#. Tag: title
#: selinux.xml:323
#, no-c-format
msgid "Selecting all &selnx; Packages in &yast;"
msgstr ""

#. Tag: para
#: selinux.xml:334
#, no-c-format
msgid ""
"After installing the &selnx; packages, you need to modify the &grub; boot "
"loader. Do this from &yast;, select <menuchoice> <guimenu>System</guimenu> "
"<guimenu>Boot Loader</guimenu> <guimenu>Kernel Parameters</guimenu></"
"menuchoice>. Now add the following parameters to the <guimenu>Optional "
"Kernel Command Line Parameters</guimenu>:"
msgstr ""

#. Tag: screen
#: selinux.xml:342
#, no-c-format
msgid "security=selinux selinux=1 enforcing=0"
msgstr ""

#. Tag: para
#: selinux.xml:344
#, no-c-format
msgid "These options are used for the following purposes:"
msgstr ""

#. Tag: literal
#: selinux.xml:350
#, no-c-format
msgid "security=selinux"
msgstr ""

#. Tag: para
#: selinux.xml:353
#, no-c-format
msgid "This option tells the kernel to use &selnx; and not &aa;"
msgstr ""

#. Tag: literal
#: selinux.xml:359
#, no-c-format
msgid "selinux=1"
msgstr ""

#. Tag: para
#: selinux.xml:362
#, no-c-format
msgid "This option switches on &selnx;"
msgstr ""

#. Tag: literal
#: selinux.xml:368
#, no-c-format
msgid "enforcing=0"
msgstr ""

#. Tag: para
#: selinux.xml:371
#, no-c-format
msgid ""
"This option puts &selnx; in permissive mode. In this mode, &selnx; is fully "
"functional, but does not enforce any of the security settings in the policy. "
"Use this mode for configuring your system. To switch on &selnx; protection, "
"when the system is fully operational, change the option to "
"<literal>enforcing=1</literal> and add <literal>SELINUX=enforcing</literal> "
"in <filename>/etc/selinux/config</filename>."
msgstr ""

#. Tag: para
#: selinux.xml:384
#, no-c-format
msgid ""
"After installing the &selnx; packages and enabling the &selnx; &grub; boot "
"options, reboot your server to activate the configuration."
msgstr ""

#. Tag: title
#: selinux.xml:390
#, no-c-format
msgid "&selnx; Policy"
msgstr ""

#. Tag: para
#: selinux.xml:392
#, no-c-format
msgid ""
"The policy is an essential component of &selnx;. &productname; "
"&productnumber; includes the <emphasis>minimum</emphasis> &selnx; reference "
"policy in the package <package>selinux-policy-minimum</package>. The "
"examples in this chapter refer to this policy if not stated otherwise."
msgstr ""

#. Tag: para
#: selinux.xml:400
#, no-c-format
msgid ""
"To install a different policy, you need to download it from <link xlink:href="
"\"https://build.opensuse.org/package/binaries/security:SELinux/selinux-"
"policy?repository=SLE_12\"></link> and install:"
msgstr ""

#. Tag: screen
#: selinux.xml:404
#, no-c-format
msgid ""
"sudo zypper in selinux-policy-targeted-<replaceable>version_number</"
"replaceable>.noarch.rpm"
msgstr ""

#. Tag: para
#: selinux.xml:407
#, no-c-format
msgid ""
"After installing the policy, you are ready to start file system labeling. Run"
msgstr ""

#. Tag: screen
#: selinux.xml:412
#, no-c-format
msgid "restorecon -Rp /"
msgstr ""

#. Tag: para
#: selinux.xml:414
#, no-c-format
msgid ""
"to start the <command>/sbin/setfiles</command> command to label all files on "
"your system. The <filename>/etc/selinux/minimum/contexts/files/"
"file_contexts</filename> input file is used. The <filename>file_contexts</"
"filename> file needs to match your actual file system as much as possible. "
"Otherwise, it can lead to a completely unbootable system. If that happens, "
"modify the records in <filename>file_contexts</filename> with the "
"<command>semanage fcontext</command> command to match the real structure of "
"the file system your server is using. For example"
msgstr ""

#. Tag: screen
#: selinux.xml:426
#, no-c-format
msgid "semanage fcontext -a -t samba_share_t /etc/example_file"
msgstr ""

#. Tag: para
#: selinux.xml:428
#, no-c-format
msgid ""
"changes the file type from the default <literal>etc_t</literal> to "
"<literal>samba_share_t</literal> and adds the following record to the "
"related <filename>file_contexts.local</filename> file:"
msgstr ""

#. Tag: screen
#: selinux.xml:434
#, no-c-format
msgid "/etc/example_file    unconfined_u:object_r:samba_share_t:s0"
msgstr ""

#. Tag: para
#: selinux.xml:436
#, no-c-format
msgid "Then run"
msgstr ""

#. Tag: screen
#: selinux.xml:440
#, no-c-format
msgid "restorecon -v /etc/example_file"
msgstr ""

#. Tag: para
#: selinux.xml:442
#, no-c-format
msgid "for the type change to take effect."
msgstr ""

#. Tag: para
#: selinux.xml:446
#, no-c-format
msgid ""
"Before doing this, make sure to read the rest of this chapter, so you fully "
"understand how context type is applied to files and directories. Do not "
"forget to make a backup of the <filename>file_contexts</filename> file "
"before starting."
msgstr ""

#. Tag: title
#: selinux.xml:454
#, no-c-format
msgid "The User <systemitem class=\"username\">nobody</systemitem>"
msgstr ""

#. Tag: para
#: selinux.xml:455
#, no-c-format
msgid ""
"While using <command>semanage</command>, you may get a message that "
"complains about the home directory of <systemitem class=\"username\">nobody</"
"systemitem>. In this case, change the login shell of user <systemitem class="
"\"username\">nobody</systemitem> to <filename>/sbin/nologin</filename>. Then "
"the settings of <systemitem class=\"username\">nobody</systemitem> match the "
"current policy settings."
msgstr ""

#. Tag: para
#: selinux.xml:466
#, no-c-format
msgid ""
"After another reboot &selnx; should be operational. To verify this, use the "
"command <command>sestatus -v</command>. It should give you an output similar "
"to <xref linkend=\"ex.selnx.sestatus\" xrefstyle=\"select:label quotedtitle "
"nopage\"/>."
msgstr ""

#. Tag: title
#: selinux.xml:474
#, no-c-format
msgid "Verifying that &selnx; is functional"
msgstr ""

#. Tag: screen
#: selinux.xml:475
#, no-c-format
msgid ""
"sestatus -v\n"
"SELinux status:                 enabled\n"
"SELinuxfs mount:                /selinux\n"
"Current mode:                   permissive\n"
"Mode from config file:          permissive\n"
"Policy version:                 26\n"
"Policy from config file:        minimum\n"
"\n"
"Process contexts:\n"
"Current context:                root:staff_r:staff_t\n"
"Init context:                   system_u:system_r:init_t\n"
"/sbin/mingetty                  system_u:system_r:sysadm_t\n"
"/usr/sbin/sshd                  system_u:system_r:sshd_t\n"
"\n"
"File contexts:\n"
"Controlling term:               root:object_r:user_devpts_t\n"
"/etc/passwd                     system_u:object_r:etc_t\n"
"/etc/shadow                     system_u:object_r:shadow_t\n"
"/bin/bash                       system_u:object_r:shell_exec_t\n"
"/bin/login                      system_u:object_r:login_exec_t\n"
"/bin/sh                         system_u:object_r:bin_t -&gt; system_u:"
"object_r:shell_exec_t\n"
"/sbin/agetty                    system_u:object_r:getty_exec_t\n"
"/sbin/init                      system_u:object_r:init_exec_t\n"
"/sbin/mingetty                  system_u:object_r:getty_exec_t\n"
"/usr/sbin/sshd                  system_u:object_r:sshd_exec_t\n"
"/lib/libc.so.6                  system_u:object_r:lib_t -&gt; system_u:"
"object_r:lib_t\n"
"/lib/ld-linux.so.2              system_u:object_r:lib_t -&gt; system_u:"
"object_r:ld_so_t"
msgstr ""

#. Tag: para
#: selinux.xml:481
#, no-c-format
msgid ""
"At this point you have a completely functional &selnx; system and it is time "
"to further configure it. In the current status, &selnx; is operational but "
"not in enforcing mode. This means that it does not limit you in doing "
"anything, it logs everything that it should be doing if it were in enforcing "
"mode. This is good, because based on the log files you can find what it is "
"that it would prevent you from doing. As a first test, put &selnx; in "
"enforcing mode and find out if you can still use your server after doing so: "
"check that the option <option>enforcing=1</option> is set in the &grub; "
"configuration file, while <option>SELINUX=enforcing</option> is set in "
"<filename>/etc/selinux/config</filename>. Reboot your server and see if it "
"still comes up the way you expect it to. If it does, leave it like that and "
"start modifying the server in a way that everything works as expected. "
"However, you may not even be able to boot the server properly. In that case, "
"switch back to the mode where &selnx; is not enforcing and start tuning your "
"server."
msgstr ""

#. Tag: para
#: selinux.xml:502
#, no-c-format
msgid ""
"Before you start tuning your server, verify the &selnx; installation. You "
"have already used the command <command>sestatus -v</command> to view the "
"current mode, process, and file contexts. Next, run"
msgstr ""

#. Tag: screen
#: selinux.xml:507 selinux.xml:821
#, no-c-format
msgid "semanage boolean -l"
msgstr ""

#. Tag: para
#: selinux.xml:508
#, no-c-format
msgid ""
"which lists all Boolean switches that are available, and at the same time "
"verifies that you can access the policy. <xref linkend=\"ex.selnx.ls.bool\"/"
"> shows part of the output of this command."
msgstr ""

#. Tag: title
#: selinux.xml:515
#, no-c-format
msgid "Getting a List of Booleans and Verifying Policy Access"
msgstr ""

#. Tag: screen
#: selinux.xml:516
#, no-c-format
msgid ""
"semanage boolean -l\n"
"SELinux boolean                          Description\n"
"ftp_home_dir                   -&gt; off   ftp_home_dir\n"
"mozilla_read_content           -&gt; off   mozilla_read_content\n"
"spamassassin_can_network       -&gt; off   spamassassin_can_network\n"
"httpd_can_network_relay        -&gt; off   httpd_can_network_relay\n"
"openvpn_enable_homedirs        -&gt; off   openvpn_enable_homedirs\n"
"gpg_agent_env_file             -&gt; off   gpg_agent_env_file\n"
"allow_httpd_awstats_script_anon_write -&gt; off   "
"allow_httpd_awstats_script_anon_write\n"
"httpd_can_network_connect_db   -&gt; off   httpd_can_network_connect_db\n"
"allow_ftpd_full_access         -&gt; off   allow_ftpd_full_access\n"
"samba_domain_controller        -&gt; off   samba_domain_controller\n"
"httpd_enable_cgi               -&gt; off   httpd_enable_cgi\n"
"virt_use_nfs                   -&gt; off   virt_use_nfs"
msgstr ""

#. Tag: para
#: selinux.xml:517
#, no-c-format
msgid "Another command that outputs useful information at this stage is"
msgstr ""

#. Tag: screen
#: selinux.xml:520 selinux.xml:660
#, no-c-format
msgid "semanage fcontext -l"
msgstr ""

#. Tag: para
#: selinux.xml:521
#, no-c-format
msgid ""
"It shows the default file context settings as provided by the policy (see "
"<xref linkend=\"ex.selnx.fcon\" xrefstyle=\"select:label quotedtitle nopage"
"\"/> for partial output of this command)."
msgstr ""

#. Tag: title
#: selinux.xml:529
#, no-c-format
msgid "Getting File Context Information"
msgstr ""

#. Tag: screen
#: selinux.xml:530
#, no-c-format
msgid ""
"semanage fcontext -l\n"
"/var/run/usb(/.*)?                                 all files          "
"system_u:object_r:hotplug_var_run_t\n"
"/var/run/utmp                                      regular file       "
"system_u:object_r:initrc_var_run_t\n"
"/var/run/vbe.*                                     regular file       "
"system_u:object_r:hald_var_run_t\n"
"/var/run/vmnat.*                                   socket             "
"system_u:object_r:vmware_var_run_t\n"
"/var/run/vmware.*                                  all files          "
"system_u:object_r:vmware_var_run_t\n"
"/var/run/vpnc(/.*)?                                all files          "
"system_u:object_r:vpnc_var_run_t\n"
"/var/run/watchdog\\.pid                             regular file       "
"system_u:object_r:watchdog_var_run_t\n"
"/var/run/winbindd(/.*)?                            all files          "
"system_u:object_r:winbind_var_run_t\n"
"/var/run/wnn-unix(/.*)                             all files          "
"system_u:object_r:canna_var_run_t\n"
"/var/run/wpa_supplicant(/.*)?                      all files          "
"system_u:object_r:NetworkManager_var_run_t\n"
"/var/run/wpa_supplicant-global                     socket             "
"system_u:object_r:NetworkManager_var_run_t\n"
"/var/run/xdmctl(/.*)?                              all files          "
"system_u:object_r:xdm_var_run_t\n"
"/var/run/yiff-[0-9]+\\.pid                          regular file       "
"system_u:object_r:soundd_var_run_t"
msgstr ""

#. Tag: title
#: selinux.xml:535
#, no-c-format
msgid "<title>Managing &selnx;</title>"
msgstr ""

#. Tag: para
#: selinux.xml:537
#, no-c-format
msgid ""
"The base &selnx; configuration is now operational and it can now be "
"configured to secure your server. In &selnx;, an additional set of rules is "
"used to define exactly which process or user can access which files, "
"directories, or ports. To do this, &selnx; applies a context to every file, "
"directory, process, and port. This context is a security label that defines "
"how this file, directory, process, or port should be treated. These context "
"labels are used by the &selnx; policy, which defines exactly what should be "
"done with the context labels. By default, the policy blocks all non-default "
"access, which means that, as an administrator, you need to enable all "
"features that are non-default on your server."
msgstr ""

#. Tag: title
#: selinux.xml:552
#, no-c-format
msgid "Viewing the Security Context"
msgstr ""

#. Tag: para
#: selinux.xml:553
#, no-c-format
msgid ""
"As already mentioned, files, directories, and ports can be labeled. Within "
"each label, different contexts are used. To be able to perform your daily "
"administration work, the type context is what you are most interested in. As "
"an administrator, you will mostly work with the type context. Many commands "
"allow you to use the <option>-Z</option> option to list current context "
"settings. In <xref linkend=\"ex.selnx.def.con\" xrefstyle=\"select:label "
"quotedtitle nopage\"/> you can see what the context settings are for the "
"directories in the root directory."
msgstr ""

#. Tag: title
#: selinux.xml:565
#, no-c-format
msgid "The default context for directories in the root directory"
msgstr ""

#. Tag: screen
#: selinux.xml:566
#, no-c-format
msgid ""
"ls -Z\n"
"dr-xr-xr-x. root root system_u:object_r:bin_t:s0       bin\n"
"dr-xr-xr-x. root root system_u:object_r:boot_t:s0      boot\n"
"drwxr-xr-x. root root system_u:object_r:cgroup_t:s0    cgroup\n"
"drwxr-xr-x+ root root unconfined_u:object_r:default_t:s0 data\n"
"drwxr-xr-x. root root system_u:object_r:device_t:s0    dev\n"
"drwxr-xr-x. root root system_u:object_r:etc_t:s0       etc\n"
"drwxr-xr-x. root root system_u:object_r:home_root_t:s0 home\n"
"dr-xr-xr-x. root root system_u:object_r:lib_t:s0       lib\n"
"dr-xr-xr-x. root root system_u:object_r:lib_t:s0       lib64\n"
"drwx------. root root system_u:object_r:lost_found_t:s0 lost+found\n"
"drwxr-xr-x. root root system_u:object_r:mnt_t:s0       media\n"
"drwxr-xr-x. root root system_u:object_r:autofs_t:s0    misc\n"
"drwxr-xr-x. root root system_u:object_r:mnt_t:s0       mnt\n"
"drwxr-xr-x. root root unconfined_u:object_r:default_t:s0 mnt2\n"
"drwxr-xr-x. root root unconfined_u:object_r:default_t:s0 mounts\n"
"drwxr-xr-x. root root system_u:object_r:autofs_t:s0    net\n"
"drwxr-xr-x. root root system_u:object_r:usr_t:s0       opt\n"
"dr-xr-xr-x. root root system_u:object_r:proc_t:s0      proc\n"
"drwxr-xr-x. root root unconfined_u:object_r:default_t:s0 repo\n"
"dr-xr-x---. root root system_u:object_r:admin_home_t:s0 root\n"
"dr-xr-xr-x. root root system_u:object_r:bin_t:s0       sbin\n"
"drwxr-xr-x. root root system_u:object_r:security_t:s0  selinux\n"
"drwxr-xr-x. root root system_u:object_r:var_t:s0       srv\n"
"-rw-r--r--. root root unconfined_u:object_r:swapfile_t:s0 swapfile\n"
"drwxr-xr-x. root root system_u:object_r:sysfs_t:s0     sys\n"
"drwxrwxrwt. root root system_u:object_r:tmp_t:s0       tmp\n"
"-rw-r--r--. root root unconfined_u:object_r:etc_runtime_t:s0 tmp2.tar\n"
"-rw-r--r--. root root unconfined_u:object_r:etc_runtime_t:s0 tmp.tar\n"
"drwxr-xr-x. root root system_u:object_r:usr_t:s0       usr\n"
"drwxr-xr-x. root root system_u:object_r:var_t:s0       var"
msgstr ""

#. Tag: para
#: selinux.xml:568
#, no-c-format
msgid ""
"In the listing above, you can see the complete context for all directories. "
"It consists of a user, a role, and a type. The s0 setting indicates the "
"security level in Multi Level Security environments. These environments are "
"not discussed here. In such an environment, make sure that s0 is set. The "
"Context Type defines what kind of activity is permitted in the directory. "
"Compare, for example, the <filename>/root</filename> directory, which has "
"the <filename>admin_home_t</filename> context type, and the <filename>/home</"
"filename> directory, which has the <filename>home_root_t</filename> context "
"type. In the &selnx; policy, different kinds of access are defined for these "
"context types."
msgstr ""

#. Tag: para
#: selinux.xml:581
#, no-c-format
msgid ""
"Security labels are not only associated with files, but also with other "
"items, such as ports and processes. In <xref linkend=\"ex.selnx.set.proc\" "
"xrefstyle=\"select:label quotedtitle nopage\"/> for example you can see the "
"context settings for processes on your server."
msgstr ""

#. Tag: title
#: selinux.xml:589
#, no-c-format
msgid "Showing &selnx; settings for processes with <command>ps Zaux</command>"
msgstr ""

#. Tag: screen
#: selinux.xml:590
#, no-c-format
msgid ""
"ps Zaux\n"
"LABEL                           USER       PID %CPU %MEM    VSZ   RSS "
"TTY      STAT START   TIME COMMAND\n"
"system_u:system_r:init_t        root         1  0.0  0.0  10640   "
"808 ?        Ss   05:31   0:00 init [5]\n"
"system_u:system_r:kernel_t      root         2  0.0  0.0      0     "
"0 ?        S    05:31   0:00 [kthreadd]\n"
"system_u:system_r:kernel_t      root         3  0.0  0.0      0     "
"0 ?        S    05:31   0:00 [ksoftirqd/0]\n"
"system_u:system_r:kernel_t      root         6  0.0  0.0      0     "
"0 ?        S    05:31   0:00 [migration/0]\n"
"system_u:system_r:kernel_t      root         7  0.0  0.0      0     "
"0 ?        S    05:31   0:00 [watchdog/0]\n"
"system_u:system_r:sysadm_t      root      2344  0.0  0.0  27640   "
"852 ?        Ss   05:32   0:00 /usr/sbin/mcelog --daemon --config-file /etc/"
"mcelog/mcelog.conf\n"
"system_u:system_r:sshd_t        root      3245  0.0  0.0  69300  "
"1492 ?        Ss   05:32   0:00 /usr/sbin/sshd -o PidFile=/var/run/sshd.init."
"pid\n"
"system_u:system_r:cupsd_t       root      3265  0.0  0.0  68176  "
"2852 ?        Ss   05:32   0:00 /usr/sbin/cupsd\n"
"system_u:system_r:nscd_t        root      3267  0.0  0.0 772876  "
"1380 ?        Ssl  05:32   0:00 /usr/sbin/nscd\n"
"system_u:system_r:postfix_master_t root   3334  0.0  0.0  38320  "
"2424 ?        Ss   05:32   0:00 /usr/lib/postfix/master\n"
"system_u:system_r:postfix_qmgr_t postfix  3358  0.0  0.0  40216  "
"2252 ?        S    05:32   0:00 qmgr -l -t fifo -u\n"
"system_u:system_r:crond_t       root      3415  0.0  0.0  14900   "
"800 ?        Ss   05:32   0:00 /usr/sbin/cron\n"
"system_u:system_r:fsdaemon_t    root      3437  0.0  0.0  16468  "
"1040 ?        S    05:32   0:00 /usr/sbin/smartd\n"
"system_u:system_r:sysadm_t      root      3441  0.0  0.0  66916  "
"2152 ?        Ss   05:32   0:00 login -- root\n"
"system_u:system_r:sysadm_t      root      3442  0.0  0.0   4596   800 "
"tty2     Ss+  05:32   0:00 /sbin/mingetty tty2"
msgstr ""

#. Tag: title
#: selinux.xml:595
#, no-c-format
msgid "Selecting the &selnx; Mode"
msgstr ""

#. Tag: para
#: selinux.xml:596
#, no-c-format
msgid "In &selnx;, three different modes can be used:"
msgstr ""

#. Tag: term
#: selinux.xml:601
#, no-c-format
msgid "Enforcing:"
msgstr ""

#. Tag: para
#: selinux.xml:603
#, no-c-format
msgid ""
"This is the default mode. &selnx; protects your server according to the "
"rules in the policy, and &selnx; logs all of its activity to the audit log."
msgstr ""

#. Tag: term
#: selinux.xml:611
#, no-c-format
msgid "Permissive:"
msgstr ""

#. Tag: para
#: selinux.xml:613
#, no-c-format
msgid ""
"This mode is useful for troubleshooting. If set to Permissive, &selnx; does "
"not protect your server, but it still logs everything that happens to the "
"log files."
msgstr ""

#. Tag: term
#: selinux.xml:621
#, no-c-format
msgid "Disabled:"
msgstr ""

#. Tag: para
#: selinux.xml:623
#, no-c-format
msgid ""
"In this mode, &selnx; is switched off completely and no logging occurs. The "
"file system labels however are not removed from the file system."
msgstr ""

#. Tag: para
#: selinux.xml:631
#, no-c-format
msgid ""
"You have already read how you can set the current &selnx; mode from &grub; "
"while booting using the enforcing boot parameter."
msgstr ""

#. Tag: title
#: selinux.xml:638
#, no-c-format
msgid "Modifying &selnx; Context Types"
msgstr ""

#. Tag: para
#: selinux.xml:639
#, no-c-format
msgid ""
"An important part of the work of an administrator is setting context types "
"on files to ensure appropriate working of &selnx;."
msgstr ""

#. Tag: para
#: selinux.xml:643
#, no-c-format
msgid ""
"If a file is created within a specific directory, it inherits the context "
"type of the parent directory by default. If, however, a file is moved from "
"one location to another location, it retains the context type that it had in "
"the old location."
msgstr ""

#. Tag: para
#: selinux.xml:649
#, no-c-format
msgid ""
"To set the context type for files, you can use the <command>semanage "
"fcontext</command> command. With this command, you write the new context "
"type to the policy, but it does not change the actual context type "
"immediately! To apply the context types that are in the policy, you need to "
"run the <command>restorecon</command> command afterward."
msgstr ""

#. Tag: para
#: selinux.xml:656
#, no-c-format
msgid ""
"The challenge when working with <command>semanage fcontext</command> is to "
"find out which context you actually need. You can use"
msgstr ""

#. Tag: para
#: selinux.xml:661
#, no-c-format
msgid ""
"to list all contexts in the policy, but it may be a bit hard to find out the "
"actual context you need from that list as it is rather long (see <xref "
"linkend=\"ex.selnx.semanage\" xrefstyle=\"select:label quotedtitle nopage\"/"
">)."
msgstr ""

#. Tag: title
#: selinux.xml:668
#, no-c-format
msgid "Viewing Default File Contexts"
msgstr ""

#. Tag: screen
#: selinux.xml:669
#, no-c-format
msgid ""
"semanage fcontext -l | less\n"
"&selnx; fcontext                                   type               "
"Context\n"
"\n"
"/                                                  directory          "
"system_u:object_r:root_t:s0\n"
"/.*                                                all files          "
"system_u:object_r:default_t:s0\n"
"/[^/]+                                             regular file       "
"system_u:object_r:etc_runtime_t:s0\n"
"/\\.autofsck                                        regular file       "
"system_u:object_r:etc_runtime_t:s0\n"
"/\\.autorelabel                                     regular file       "
"system_u:object_r:etc_runtime_t:s0\n"
"/\\.journal                                         all files          X:&gt;"
"&gt;None&gt;&gt;\n"
"/\\.suspended                                       regular file       "
"system_u:object_r:etc_runtime_t:s0\n"
"/a?quota\\.(user|group)                             regular file       "
"system_u:object_r:quota_db_t:s0\n"
"/afs                                               directory          "
"system_u:object_r:mnt_t:s0\n"
"/bin                                               directory          "
"system_u:object_r:bin_t:s0\n"
"/bin/.*                                            all files          "
"system_u:object_r:bin_t:s0"
msgstr ""

#. Tag: para
#: selinux.xml:671
#, no-c-format
msgid ""
"There are three ways to find out which context settings are available for "
"your services:"
msgstr ""

#. Tag: para
#: selinux.xml:677
#, no-c-format
msgid ""
"Install the service and look at the default context settings that are used. "
"This is the easiest and recommended option."
msgstr ""

#. Tag: para
#: selinux.xml:683
#, no-c-format
msgid ""
"Consult the man page for the specific service. Some services have a man page "
"that ends in <literal>_selinux</literal>, which contains all the information "
"you need to find the correct context settings."
msgstr ""

#. Tag: para
#: selinux.xml:688
#, no-c-format
msgid ""
"When you have found the right context setting, apply it using "
"<command>semanage fcontext</command>. This command takes <option>-t</option> "
"context type as its first argument, followed by the name of the directory or "
"file to which you want to apply the context settings. To apply the context "
"to everything that already exists in the directory where you want to apply "
"the context, you add the regular expression <literal>(/.*)?</literal> to the "
"name of the directory. This means: optionally, match a slash followed by any "
"character. The examples section of the <command>semanage</command> man page "
"has some useful usage examples for <command>semanage</command>. For more "
"information on regular expressions, see for example the tutorial at <link "
"xlink:href=\"http://www.regular-expressions.info/\"></link>."
msgstr ""

#. Tag: para
#: selinux.xml:704
#, no-c-format
msgid "Display a list of all context types that are available on your system:"
msgstr ""

#. Tag: screen
#: selinux.xml:707
#, no-c-format
msgid "seinfo -t"
msgstr ""

#. Tag: para
#: selinux.xml:708
#, no-c-format
msgid ""
"Since the command by itself outputs an overwhelming amount of information, "
"it should be used in combination with <command>grep</command> or a similar "
"command for filtering."
msgstr ""

#. Tag: title
#: selinux.xml:718
#, no-c-format
msgid "Applying File Contexts"
msgstr ""

#. Tag: para
#: selinux.xml:719
#, no-c-format
msgid ""
"To help you apply the &selnx; context properly, the following procedure "
"shows how to set a context using <command>semanage fcontext</command> and "
"<command>restorecon</command>. You will notice that at first attempt, the "
"Web server with a non-default document root does not work. After changing "
"the &selnx; context, it will:"
msgstr ""

#. Tag: para
#: selinux.xml:727
#, no-c-format
msgid "Create the <filename>/web</filename> directory and then change to it:"
msgstr ""

#. Tag: screen
#: selinux.xml:730
#, no-c-format
msgid "sudo mkdir /web  &amp;&amp; cd /web"
msgstr ""

#. Tag: para
#: selinux.xml:733
#, no-c-format
msgid ""
"Use a text editor to create the file <filename>/web/index.html</filename> "
"that contains the text welcome to my Web site."
msgstr ""

#. Tag: para
#: selinux.xml:740
#, no-c-format
msgid ""
"Open the file <filename>/etc/apache2/default-server.conf</filename> with an "
"editor, and change the DocumentRoot line to <literal>DocumentRoot /web</"
"literal>"
msgstr ""

#. Tag: para
#: selinux.xml:747
#, no-c-format
msgid "Start the Apache Web server:"
msgstr ""

#. Tag: screen
#: selinux.xml:750
#, no-c-format
msgid "sudo systemctl start apache2"
msgstr ""

#. Tag: para
#: selinux.xml:753
#, no-c-format
msgid "Open a session to your local Web server:"
msgstr ""

#. Tag: screen
#: selinux.xml:756
#, no-c-format
msgid "w3m localhost"
msgstr ""

#. Tag: para
#: selinux.xml:757
#, no-c-format
msgid ""
"You will receive a <emphasis>Connection refused</emphasis> message. Press "
"<keycap function=\"enter\"></keycap>, and then <command>q</command> to quit "
"w3m."
msgstr ""

#. Tag: para
#: selinux.xml:764
#, no-c-format
msgid ""
"Find the current context type for the default Apache <literal>DocumentRoot</"
"literal>, which is <filename>/srv/www/htdocs</filename>. It should be set to "
"<filename>httpd_sys_content_t</filename>:"
msgstr ""

#. Tag: screen
#: selinux.xml:770
#, no-c-format
msgid "ls -Z /srv/www"
msgstr ""

#. Tag: para
#: selinux.xml:773
#, no-c-format
msgid ""
"Set the new context in the policy and press <keycap function=\"enter\"></"
"keycap>:"
msgstr ""

#. Tag: screen
#: selinux.xml:777
#, no-c-format
msgid "semanage fcontext -a -f \"\" -t httpd_sys_content_t '/web(/.*) ?'"
msgstr ""

#. Tag: para
#: selinux.xml:780
#, no-c-format
msgid "Apply the new context type:"
msgstr ""

#. Tag: screen
#: selinux.xml:783
#, no-c-format
msgid "restorecon /web"
msgstr ""

#. Tag: para
#: selinux.xml:786
#, no-c-format
msgid ""
"Show the context of the files in the directory <filename>/web</filename>. "
"You will see that the new context type has been set properly to the "
"<filename>/web</filename> directory, but not to its contents."
msgstr ""

#. Tag: screen
#: selinux.xml:792
#, no-c-format
msgid "ls -Z /web"
msgstr ""

#. Tag: para
#: selinux.xml:795
#, no-c-format
msgid ""
"Apply the new context recursively to the <filename>/web</filename> "
"directory. The type context has now been set correctly."
msgstr ""

#. Tag: screen
#: selinux.xml:799
#, no-c-format
msgid "restorecon -R /web"
msgstr ""

#. Tag: para
#: selinux.xml:802
#, no-c-format
msgid "Restart the Web server:"
msgstr ""

#. Tag: screen
#: selinux.xml:805
#, no-c-format
msgid "sudo systemctl restart apache2"
msgstr ""

#. Tag: para
#: selinux.xml:806
#, no-c-format
msgid ""
"You should now be able to access the contents of the <filename>/web</"
"filename> directory."
msgstr ""

#. Tag: title
#: selinux.xml:815
#, no-c-format
msgid "Configuring &selnx; Policies"
msgstr ""

#. Tag: para
#: selinux.xml:816
#, no-c-format
msgid ""
"The easiest way to change the behavior of the policy is by working with "
"Booleans. These are on-off switches that you can use to change the settings "
"in the policy. To find out which Booleans are available, run"
msgstr ""

#. Tag: para
#: selinux.xml:822
#, no-c-format
msgid ""
"It will show a long list of Booleans, with a short description of what each "
"of these Booleans will do for you. When you have found the Boolean you want "
"to set, you can use <command>setsebool -P</command>, followed by the name of "
"the Boolean that you want to change. It is important to use the <option>-P</"
"option> option at all times when using <command>setsebool</command>. This "
"option writes the setting to the policy file on disk, and this is the only "
"way to make sure that the Boolean is applied automatically after a reboot."
msgstr ""

#. Tag: para
#: selinux.xml:832
#, no-c-format
msgid "The procedure below gives an example of changing Boolean settings"
msgstr ""

#. Tag: para
#: selinux.xml:837
#, no-c-format
msgid "List Booleans that are related to FTP servers."
msgstr ""

#. Tag: screen
#: selinux.xml:839
#, no-c-format
msgid "semanage boolean -l | grep ftp"
msgstr ""

#. Tag: para
#: selinux.xml:842
#, no-c-format
msgid "Turn the Boolean off:"
msgstr ""

#. Tag: screen
#: selinux.xml:845
#, no-c-format
msgid "setsebool allow_ftpd_anon_write off"
msgstr ""

#. Tag: para
#: selinux.xml:846
#, no-c-format
msgid ""
"Note that it does not take much time to write the change. Then verify that "
"the Boolean is indeed turned off:"
msgstr ""

#. Tag: screen
#: selinux.xml:849
#, no-c-format
msgid "semanage boolean -l|grep ftpd_anon"
msgstr ""

#. Tag: para
#: selinux.xml:852
#, no-c-format
msgid "Reboot your server."
msgstr ""

#. Tag: para
#: selinux.xml:857
#, no-c-format
msgid ""
"Check again to see if the <literal>allow_ftpd_anon_write</literal> Boolean "
"is still turned on. As it has not yet been written to the policy, you will "
"notice that it is off."
msgstr ""

#. Tag: para
#: selinux.xml:864
#, no-c-format
msgid "Switch the Boolean and write the setting to the policy:"
msgstr ""

#. Tag: screen
#: selinux.xml:867
#, no-c-format
msgid "setsebool -P allow_ftpd_anon_write"
msgstr ""

#. Tag: title
#: selinux.xml:873
#, no-c-format
msgid "Working with &selnx; Modules"
msgstr ""

#. Tag: para
#: selinux.xml:874
#, no-c-format
msgid ""
"By default, &selnx; uses a modular policy. This means that the policy that "
"implements &selnx; features is not just one huge policy, but it consists of "
"many smaller modules. Each module covers a specific part of the &selnx; "
"configuration. The concept of the &selnx; module was introduced to make it "
"easier for third party vendors to make their services compatible with "
"&selnx;. To get an overview of the &selnx; modules, you can use the "
"<command>semodule -l</command> command. This command lists all current "
"modules in use by &selnx; and their version numbers."
msgstr ""

#. Tag: para
#: selinux.xml:885
#, no-c-format
msgid ""
"As an administrator, you can switch modules on or off. This can be useful if "
"you want to disable only a part of &selnx; and not everything to run a "
"specific service without &selnx; protection. Especially in the case of "
"&productname;, where there is not a completely supported &selnx; policy yet, "
"it can make sense to switch off all modules that you do not need so that you "
"can focus on the services that really do need &selnx; protection. To switch "
"off an &selnx; module, use"
msgstr ""

#. Tag: screen
#: selinux.xml:894
#, no-c-format
msgid "semodule -d <replaceable>modulename</replaceable>"
msgstr ""

#. Tag: para
#: selinux.xml:895
#, no-c-format
msgid "If you want to switch it on again, you can use"
msgstr ""

#. Tag: screen
#: selinux.xml:898
#, no-c-format
msgid "semodule -e modulename"
msgstr ""

#. Tag: para
#: selinux.xml:966
#, no-c-format
msgid ""
"As an administrator, you do not typically change the contents of the policy "
"files that come from the &selnx; Policy RPM. You would rather use "
"<command>semanage fcontext</command> to change file contexts. If you are "
"using <command>audit2allow</command> to generate policies for your server, "
"you should change the policy files after all."
msgstr ""

#. Tag: para
#: selinux.xml:973
#, no-c-format
msgid ""
"To change the contents of any of the policy module files, compile the "
"changes into a new policy module file. To do this, first install the "
"<systemitem>selinux-policy-devel</systemitem> package. Then, in the "
"directory where the files created by <command>audit2allow</command> are "
"located, run:"
msgstr ""

#. Tag: screen
#: selinux.xml:980
#, no-c-format
msgid "make -f /usr/share/selinux/devel/Makefile"
msgstr ""

#. Tag: para
#: selinux.xml:981
#, no-c-format
msgid ""
"When <command>make</command> has completed, you can manually load the "
"modules into the system, using <command>semodule -i</command>."
msgstr ""

#. Tag: title
#: selinux.xml:988
#, no-c-format
msgid "Troubleshooting"
msgstr ""

#. Tag: para
#: selinux.xml:990
#, no-c-format
msgid ""
"By default, if &selnx; is the reason something is not working, a log message "
"to this effect is sent to the <filename>/var/log/audit/audit.log</filename> "
"file. That is, if the auditd service is running. If you see an empty "
"<filename>/var/log/audit</filename>, start the auditd service using"
msgstr ""

#. Tag: screen
#: selinux.xml:998
#, no-c-format
msgid "sudo systemctl start auditd"
msgstr ""

#. Tag: para
#: selinux.xml:1000
#, no-c-format
msgid "and enable it in the targets of your system, using"
msgstr ""

#. Tag: screen
#: selinux.xml:1004
#, no-c-format
msgid "sudo systemctl enable auditd"
msgstr ""

#. Tag: para
#: selinux.xml:1006
#, no-c-format
msgid ""
"In <xref linkend=\"ex.selnx.li.auditlog\" xrefstyle=\"select:label "
"quotedtitle nopage\"/> you can see a partial example of the contents of "
"<filename>/var/log/audit/audit.log</filename>"
msgstr ""

#. Tag: title
#: selinux.xml:1014
#, no-c-format
msgid "Example Lines from <filename>/etc/audit/audit.log</filename>"
msgstr ""

#. Tag: screen
#: selinux.xml:1015
#, no-c-format
msgid ""
"type=DAEMON_START msg=audit(1348173810.874:6248): auditd start, ver=1.7.7 "
"format=raw kernel=3.0.13-0.27-default auid=0 pid=4235 subj=system_u:system_r:"
"auditd_t res=success\n"
"type=AVC msg=audit(1348173901.081:292): avc:  denied  { write } for  "
"pid=3426 comm=\"smartd\" name=\"smartmontools\" dev=sda6 ino=581743 "
"scontext=system_u:system_r:fsdaemon_t tcontext=system_u:object_r:var_lib_t "
"tclass=dir\n"
"type=AVC msg=audit(1348173901.081:293): avc:  denied  { remove_name } for  "
"pid=3426 comm=\"smartd\" name=\"smartd.WDC_WD2500BEKT_75PVMT0-"
"WD_WXC1A21E0454.ata.state~\" dev=sda6 ino=582390 scontext=system_u:system_r:"
"fsdaemon_t tcontext=system_u:object_r:var_lib_t tclass=dir\n"
"type=AVC msg=audit(1348173901.081:294): avc:  denied  { unlink } for  "
"pid=3426 comm=\"smartd\" name=\"smartd.WDC_WD2500BEKT_75PVMT0-"
"WD_WXC1A21E0454.ata.state~\" dev=sda6 ino=582390 scontext=system_u:system_r:"
"fsdaemon_t tcontext=system_u:object_r:var_lib_t tclass=file\n"
"type=AVC msg=audit(1348173901.081:295): avc:  denied  { rename } for  "
"pid=3426 comm=\"smartd\" name=\"smartd.WDC_WD2500BEKT_75PVMT0-"
"WD_WXC1A21E0454.ata.state\" dev=sda6 ino=582373 scontext=system_u:system_r:"
"fsdaemon_t tcontext=system_u:object_r:var_lib_t tclass=file\n"
"type=AVC msg=audit(1348173901.081:296): avc:  denied  { add_name } for  "
"pid=3426 comm=\"smartd\" name=\"smartd.WDC_WD2500BEKT_75PVMT0-"
"WD_WXC1A21E0454.ata.state~\" scontext=system_u:system_r:fsdaemon_t "
"tcontext=system_u:object_r:var_lib_t tclass=dir\n"
"type=AVC msg=audit(1348173901.081:297): avc:  denied  { create } for  "
"pid=3426 comm=\"smartd\" name=\"smartd.WDC_WD2500BEKT_75PVMT0-"
"WD_WXC1A21E0454.ata.state\" scontext=system_u:system_r:fsdaemon_t "
"tcontext=system_u:object_r:var_lib_t tclass=file\n"
"type=AVC msg=audit(1348173901.081:298): avc:  denied  { write open } for  "
"pid=3426 comm=\"smartd\" name=\"smartd.WDC_WD2500BEKT_75PVMT0-"
"WD_WXC1A21E0454.ata.state\" dev=sda6 ino=582390 scontext=system_u:system_r:"
"fsdaemon_t tcontext=system_u:object_r:var_lib_t tclass=file\n"
"type=AVC msg=audit(1348173901.081:299): avc:  denied  { getattr } for  "
"pid=3426 comm=\"smartd\" path=\"/var/lib/smartmontools/smartd."
"WDC_WD2500BEKT_75PVMT0-WD_WXC1A21E0454.ata.state\" dev=sda6 ino=582390 "
"scontext=system_u:system_r:fsdaemon_t tcontext=system_u:object_r:var_lib_t "
"tclass=file\n"
"type=AVC msg=audit(1348173901.309:300): avc:  denied  { append } for  "
"pid=1316"
msgstr ""

#. Tag: para
#: selinux.xml:1018
#, no-c-format
msgid ""
"At first look, the lines in <filename>audit.log</filename> are a bit hard to "
"read. However, on closer examination they are not that hard to understand. "
"Every line can be broken down into sections. For example, the sections in "
"the last line are:"
msgstr ""

#. Tag: term
#: selinux.xml:1027
#, no-c-format
msgid "<literal>type=AVC</literal>:"
msgstr ""

#. Tag: para
#: selinux.xml:1029
#, no-c-format
msgid ""
"every &selnx;-related audit log line starts with the type identification "
"<literal>type=AVC</literal>"
msgstr ""

#. Tag: term
#: selinux.xml:1036
#, no-c-format
msgid "<literal>msg=audit(1348173901.309:300)</literal>:"
msgstr ""

#. Tag: para
#: selinux.xml:1038
#, no-c-format
msgid ""
"This is the time stamp, which unfortunately is written in epoch time, the "
"number of seconds that have passed since Jan 1, 1970. You can use "
"<command>date -d</command> on the part up to the dot in the epoch time "
"notation to find out when the event has happened:"
msgstr ""

#. Tag: screen
#: selinux.xml:1044
#, no-c-format
msgid ""
"date -d @1348173901\n"
"Thu Sep 20 16:45:01 EDT 2012"
msgstr ""

#. Tag: term
#: selinux.xml:1048
#, no-c-format
msgid "<literal>avc: denied { append }</literal>:"
msgstr ""

#. Tag: para
#: selinux.xml:1050
#, no-c-format
msgid ""
"the specific action that was denied. In this case the system has denied the "
"appending of data to a file. While browsing through the audit log file, you "
"can see other system actions, such as write open, getattr and more."
msgstr ""

#. Tag: term
#: selinux.xml:1059
#, no-c-format
msgid "<literal>for pid=1316</literal>:"
msgstr ""

#. Tag: para
#: selinux.xml:1061
#, no-c-format
msgid "the process ID of the command or process that initiated the action"
msgstr ""

#. Tag: term
#: selinux.xml:1067
#, no-c-format
msgid "<literal>comm=\"rsyslogd\"</literal>:"
msgstr ""

#. Tag: para
#: selinux.xml:1069
#, no-c-format
msgid "the specific command that was associated with that PID"
msgstr ""

#. Tag: term
#: selinux.xml:1075
#, no-c-format
msgid "<literal>name=\"smartmontools\"</literal>:"
msgstr ""

#. Tag: para
#: selinux.xml:1077
#, no-c-format
msgid "the name of the subject of the action"
msgstr ""

#. Tag: term
#: selinux.xml:1083
#, no-c-format
msgid "<literal>dev=sda6 ino=582296</literal>:"
msgstr ""

#. Tag: para
#: selinux.xml:1085
#, no-c-format
msgid "the block device and inode number of the file that was involved"
msgstr ""

#. Tag: term
#: selinux.xml:1091
#, no-c-format
msgid "<literal>scontext=system_u:system_r:syslogd_t</literal>:"
msgstr ""

#. Tag: para
#: selinux.xml:1093
#, no-c-format
msgid "the source context, which is the context of the initiator of the action"
msgstr ""

#. Tag: term
#: selinux.xml:1100
#, no-c-format
msgid "<literal>tclass=file</literal>:"
msgstr ""

#. Tag: para
#: selinux.xml:1102
#, no-c-format
msgid "a class identification of the subject"
msgstr ""

#. Tag: para
#: selinux.xml:1109
#, no-c-format
msgid ""
"Instead of interpreting the events in audit.log yourself, there is another "
"approach. You can use the <command>audit2allow</command> command, which "
"helps analyze the cryptic log messages in <filename>/var/log/audit/audit."
"log</filename>. An audit2allow troubleshooting session always consists of "
"three different commands. First, you would use <command>audit2allow -w -a</"
"command> to present the audit information in a more readable way. The "
"<command>audit2allow -w -a</command> by default works on the audit.log file. "
"If you want to analyze a specific message in the audit.log file, copy it to "
"a temporary file and analyze the file with:"
msgstr ""

#. Tag: screen
#: selinux.xml:1122
#, no-c-format
msgid "audit2allow -w -i <replaceable>file_name</replaceable>"
msgstr ""

#. Tag: title
#: selinux.xml:1125
#, no-c-format
msgid "Analyzing Audit Messages"
msgstr ""

#. Tag: screen
#: selinux.xml:1126
#, no-c-format
msgid ""
"audit2allow -w -i testfile\n"
"type=AVC msg=audit(1348173901.309:300): avc:  denied  { append } for  "
"pid=1316\n"
"comm=\"rsyslogd\" name=\"acpid\" dev=sda6 ino=582296\n"
"scontext=system_u:system_r:syslogd_t tcontext=system_u:object_r:apmd_log_t "
"tclass=file"
msgstr ""

#. Tag: term
#: selinux.xml:1131
#, no-c-format
msgid "This was caused by:"
msgstr ""

#. Tag: para
#: selinux.xml:1133
#, no-c-format
msgid "Missing type enforcement (TE) allow rule."
msgstr ""

#. Tag: para
#: selinux.xml:1136
#, no-c-format
msgid "To generate a loadable module to allow this access, run"
msgstr ""

#. Tag: screen
#: selinux.xml:1139
#, no-c-format
msgid "audit2allow"
msgstr ""

#. Tag: para
#: selinux.xml:1144
#, no-c-format
msgid ""
"To find out which specific rule has denied access, you can use "
"<command>audit2allow -a</command> to show the enforcing rules from all "
"events that were logged to the <filename>audit.log </filename> file, or "
"<command>audit2allow -i <replaceable>file_name</replaceable></command> to "
"show it for messages that you have stored in a specific file:"
msgstr ""

#. Tag: title
#: selinux.xml:1153
#, no-c-format
msgid "Viewing Which Lines Deny Access"
msgstr ""

#. Tag: screen
#: selinux.xml:1154
#, no-c-format
msgid ""
"audit2allow -i testfile\n"
"#============= syslogd_t ==============\n"
"allow syslogd_t apmd_log_t:file append;"
msgstr ""

#. Tag: para
#: selinux.xml:1157
#, no-c-format
msgid ""
"To create an &selnx; module with the name <literal>mymodule</literal> that "
"you can load to allow the access that was previously denied, run"
msgstr ""

#. Tag: screen
#: selinux.xml:1162
#, no-c-format
msgid "audit2allow -a -R -M mymodule"
msgstr ""

#. Tag: para
#: selinux.xml:1164
#, no-c-format
msgid ""
"If you want to do this for all events that have been logged to the audit."
"log, use the <option>-a -M</option> command arguments. To do it only for "
"specific messages that are in a specific file, use <option>-i -M</option> as "
"in the example below:"
msgstr ""

#. Tag: title
#: selinux.xml:1172
#, no-c-format
msgid "Creating a Policy Module Allowing an Action Previously Denied"
msgstr ""

#. Tag: screen
#: selinux.xml:1173
#, no-c-format
msgid ""
"audit2allow -i testfile -M example\n"
"******************** IMPORTANT ***********************\n"
"To make this policy package active, execute:\n"
"\n"
"semodule -i example.pp"
msgstr ""

#. Tag: para
#: selinux.xml:1176
#, no-c-format
msgid ""
"As indicated by the <command>audit2allow</command> command, you can now run "
"this module by using the <command>semodule -i</command> command, followed by "
"the name of the module that <command>audit2allow</command> has created for "
"you (<filename>example.pp</filename> in the above example)."
msgstr ""
